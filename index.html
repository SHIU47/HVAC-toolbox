<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Êù±Êó≠ÁöÑ HVAC Pro-Suite | Â∞àÊ•≠Á©∫Ë™øË®≠Ë®àÁ∂≤Á´ô</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2563eb">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="HVAC Pro">
    <link rel="apple-touch-icon" href="icon-192.png">

    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='25' fill='%232563eb'/><text x='50%' y='54%' dominant-baseline='central' text-anchor='middle' font-family='system-ui, sans-serif' font-size='65' font-weight='900' fill='white'>H</text></svg>">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Noto+Sans+TC:wght@400;500;700&family=JetBrains+Mono:wght@500;700&display=swap" rel="stylesheet">
    
    <script
      crossorigin="anonymous"
      data-clerk-publishable-key="pk_test_ZG1zY3JldGUtZmlsbHktNTkuY2xlcmsuYWNjb3VudHMuZGV2JAA"
      src="https://discrete-filly-59.clerk.accounts.dev/npm/@clerk/clerk-js@latest/dist/clerk.browser.js"
      type="text/javascript">
    </script>

    <style>
        :root { --primary-blue: #2563eb; --soft-blue: #eff6ff; --border-light: rgba(226, 232, 240, 0.8); --obsidian-black: #0f172a; }
        body { font-family: 'Plus Jakarta Sans', 'Noto Sans TC', sans-serif; background: #f8fafc; color: #1e293b; overflow: hidden; margin: 0; perspective: 2000px; -webkit-tap-highlight-color: transparent; }
        #boot-loader { position: fixed; inset: 0; background: #ffffff; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.6s cubic-bezier(0.65, 0, 0.35, 1); will-change: opacity; }
        .boot-bar { width: 240px; height: 3px; background: #eff6ff; margin-top: 24px; border-radius: 99px; position: relative; overflow: hidden; }
        .boot-progress { position: absolute; height: 100%; width: 0%; background: var(--primary-blue); box-shadow: 0 0 15px var(--primary-blue); animation: bootProgress 1.4s cubic-bezier(0.23, 1, 0.32, 1) forwards; }
        @keyframes bootProgress { 0% { width: 0%; } 100% { width: 100%; } }
        .mesh-bg { position: fixed; inset: 0; z-index: -1; background: radial-gradient(at var(--mouse-x, 50%) var(--mouse-y, 50%), rgba(37, 99, 235, 0.08) 0px, transparent 40%); background-color: #f8fafc; }
        .slider-container { display: flex; overflow-x: auto; gap: 20px; padding: 70px 0; scrollbar-width: none; scroll-snap-type: x mandatory; }
        .tool-card { flex: 0 0 280px; background: rgba(255, 255, 255, 0.95); border-radius: 2.5rem; padding: 2.5rem; transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1); cursor: pointer; height: 320px; scroll-snap-align: center; opacity: 0.15; transform: scale(0.85); }
        .tool-card.active-center { opacity: 1; transform: scale(1.1) translateY(-20px); border: 2px solid var(--primary-blue); z-index: 50; }
        #module-container { position: fixed; inset: 0; z-index: 9000; background: white; display: none; flex-direction: column; }
        #module-viewport { flex-grow: 1; border: none; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="h-screen flex flex-col">

    <div id="boot-loader">
        <div class="flex flex-col items-center">
            <div class="w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center text-white font-black text-2xl shadow-2xl mb-8">Êù±Êó≠</div>
            <div id="boot-status" class="text-[8px] font-mono text-slate-400 uppercase tracking-[0.3em] mt-4">Initializing Logic Core...</div>
            <div class="boot-bar"><div class="boot-progress"></div></div>
        </div>
    </div>

    <header class="h-[64px] md:h-[88px] bg-white/80 backdrop-blur-md border-b border-slate-200 px-4 md:px-12 flex items-center justify-between z-[110]">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-blue-600 rounded-xl flex items-center justify-center text-white font-black">Êù±Êó≠</div>
            <h1 class="text-xl md:text-3xl font-black text-slate-800">HVAC <span class="text-blue-600">PRO-SUITE</span></h1>
        </div>
        <div class="flex items-center gap-4">
            <div id="current-time" class="font-mono font-bold hidden sm:block">--:--</div>
            <div id="user-button"></div>
        </div>
    </header>

    <main id="toolbox-hub" class="flex-grow p-6 md:p-20 overflow-y-auto no-scrollbar">
        <div class="max-w-6xl mx-auto">
            <div id="welcome-badge" class="inline-block px-5 py-2 bg-blue-600 text-white text-[10px] font-black uppercase tracking-[0.5em] rounded-full mb-6">SYSTEM READY</div>
            <h2 class="text-5xl md:text-7xl font-black text-slate-900 mb-6">Â∞àÊ•≠Á©∫Ë™øÂ∑•ÂÖ∑ÁÆ±</h2>
            <div id="general-slider" class="slider-container no-scrollbar"></div>
            <div id="advanced-slider" class="slider-container no-scrollbar mt-10"></div>
        </div>
    </main>

    <div id="module-container">
        <div class="h-16 bg-slate-900 text-white flex items-center px-8 justify-between">
            <button onclick="closeModule()" class="font-bold text-xs bg-white/10 px-4 py-2 rounded-full">TERMINATE</button>
            <span id="active-tool-title" class="font-black">LOADING...</span>
            <div></div>
        </div>
        <iframe id="module-viewport" src="about:blank"></iframe>
    </div>

    <script>
        // Ê†∏ÂøÉÂïüÂãïËàáÈ©óË≠âÈÇèËºØ
        window.onload = async () => {
            const loader = document.getElementById('boot-loader');
            const status = document.getElementById('boot-status');

            if (typeof Clerk === 'undefined') {
                status.innerText = "AUTH BLOCKED - CHECK ADBLOCK";
                status.style.color = "red";
                return;
            }

            try {
                status.innerText = "AUTHENTICATING...";
                await Clerk.load();
                
                // Ê†∏ÂøÉÂà§ÂÆöÔºöÂêåÊôÇÊ™¢Êü• session Ëàá user
                if (!Clerk.session || !Clerk.user) {
                    Clerk.openSignIn({ 
                        afterSignInUrl: 'https://shiu47.github.io/HVAC-toolbox/' 
                    });
                    return;
                }

                // --- ÊàêÂäüÁôªÂÖ•ÂæåÂü∑Ë°å ---
                // 1. ÂÄã‰∫∫ÂåñÊ≠°ËøéË©û
                const userName = Clerk.user.firstName || Clerk.user.primaryEmailAddress.emailAddress.split('@')[0];
                document.getElementById('welcome-badge').innerText = `Ê≠°ËøéÂõû‰æÜÔºå${userName} Â∑•Á®ãÂ∏´`;

                // 2. ÊéõËºâÊåâÈàï
                Clerk.mountUserButton(document.getElementById('user-button'));

                // 3. Ê∏≤ÊüìÊªëËªå
                renderAllTools();

                // 4. ÈóúÈñâÂïüÂãïÁï´Èù¢
                setTimeout(() => {
                    loader.style.opacity = '0';
                    setTimeout(() => loader.style.display = 'none', 600);
                }, 800);

            } catch (e) {
                status.innerText = "AUTH ERROR - REFRESH";
                console.error(e);
            }

            // Êõ¥Êñ∞ÊôÇÈñì
            setInterval(() => {
                document.getElementById('current-time').innerText = new Date().toLocaleTimeString('zh-TW', { hour12: false, hour: '2-digit', minute: '2-digit' });
            }, 1000);
        };

        const toolsData = {
            general: [
                { name: 'ÂÜ∞Ê©üÊ∞¥Ê≥µÊèõÁÆó', file: 'ÂÜ∞Ê©üÊèõÁÆóÊ∞¥Ê≥µ.html', icon: '‚ö°' },
                { name: 'Â∑•Á®ãÊèõÁÆóÂô®', file: 'Á©∫Ë™øÂ∑•Á®ãÂ∞àÊ•≠ÊèõÁÆóÂ∑•ÂÖ∑.html', icon: 'üîÑ' },
                { name: 'È¢®ÁÆ°Â∞∫ÂØ∏Ê™¢Ê†∏', file: 'È¢®ÁÆ°Ë®àÁÆó.html', icon: 'üí®' }
            ],
            advanced: [
                { name: 'Â∞àÊ•≠Â£ìÊêçË®àÁÆóÊõ∏', file: 'Ê∞¥ÁÆ°È¢®ÁÆ°Â£ìÊêçË®àÁÆó.html', icon: 'üìê' },
                { name: 'ÁÑ°Â°µÂÆ§Â§ßÂ∏´ Pro', file: 'Clean room master.html', icon: 'üèóÔ∏è' }
            ]
        };

        function renderAllTools() {
            const createHTML = t => `<div onclick="openTool('${t.name}', '${t.file}')" class="tool-card active-center">
                <div class="text-4xl mb-4">${t.icon}</div>
                <h4 class="text-xl font-black">${t.name}</h4>
                <div class="mt-4 text-blue-600 font-bold text-xs">ENTER ‚Üí</div>
            </div>`;
            document.getElementById('general-slider').innerHTML = toolsData.general.map(createHTML).join('');
            document.getElementById('advanced-slider').innerHTML = toolsData.advanced.map(createHTML).join('');
        }

        function openTool(name, file) {
            document.getElementById('active-tool-title').innerText = name;
            document.getElementById('module-viewport').src = file;
            document.getElementById('module-container').style.display = 'flex';
        }

        function closeModule() {
            document.getElementById('module-container').style.display = 'none';
            document.getElementById('module-viewport').src = 'about:blank';
        }
    </script>
</body>
</html>
